<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Employee Portal - Aquatic Nature Discovery</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .portal-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 80px;
        }

        .portal-header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #0066cc;
        }

        .portal-header h2 {
            color: #0066cc;
            margin-bottom: 0.5rem;
            font-size: 2.5rem;
        }

        .portal-header p {
            color: #666;
            font-size: 1.2rem;
        }

        .welcome-banner {
            background: linear-gradient(135deg, #0066cc, #004d99);
            color: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .welcome-banner h3 {
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }

        .welcome-banner p {
            margin: 0;
            opacity: 0.9;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .tool-card {
            background: white;
            border: 2px solid #e6e6e6;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tool-card:hover {
            border-color: #0066cc;
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 102, 204, 0.15);
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0066cc, #004d99);
        }

        .tool-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }

        .tool-card h3 {
            color: #0066cc;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .tool-card p {
            color: #666;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .tool-button {
            background-color: #0066cc;
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            display: inline-block;
            transition: background-color 0.3s;
            font-weight: bold;
        }

        .tool-button:hover {
            background-color: #0055b3;
        }

        .status-panel {
            background-color: #e6f3ff;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .status-panel h3 {
            color: #0066cc;
            margin-bottom: 1rem;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .status-item {
            background: white;
            padding: 1rem;
            border-radius: 4px;
            border-left: 4px solid #0066cc;
        }

        .status-item h4 {
            margin: 0 0 0.5rem 0;
            color: #0066cc;
        }

        .status-item p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }

        .quick-actions {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .quick-actions h3 {
            color: #0066cc;
            margin-bottom: 1rem;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .action-button {
            background-color: #28a745;
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .action-button:hover {
            background-color: #218838;
        }

        .action-button.warning {
            background-color: #ffc107;
            color: #212529;
        }

        .action-button.warning:hover {
            background-color: #e0a800;
        }

        .action-button.danger {
            background-color: #dc3545;
        }

        .action-button.danger:hover {
            background-color: #c82333;
        }

        .login-required {
            text-align: center;
            padding: 3rem;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin: 2rem auto;
            max-width: 500px;
        }

        .login-required h3 {
            color: #dc3545;
            margin-bottom: 1rem;
        }

        .login-required p {
            color: #666;
            margin-bottom: 1.5rem;
        }

        .login-button {
            background-color: #0066cc;
            color: white;
            text-decoration: none;
            padding: 1rem 2rem;
            border-radius: 4px;
            display: inline-block;
            transition: background-color 0.3s;
        }

        .login-button:hover {
            background-color: #0055b3;
        }

        .logout-section {
            text-align: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e6e6e6;
        }

        .logout-button {
            background-color: #6c757d;
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #5a6268;
        }

        .action-status {
            display: none;
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            font-size: 0.95rem;
            border: 1px solid transparent;
        }

        .action-status.success {
            display: block;
            background: #e8f7ee;
            border-color: #2fad73;
            color: #1e7a50;
        }

        .action-status.info {
            display: block;
            background: #e8f1fb;
            border-color: #4a86e8;
            color: #1f4e99;
        }

        .action-status.warning {
            display: block;
            background: #fff6e5;
            border-color: #f0a202;
            color: #9c6500;
        }

        .multi-tab-banner {
            display: none;
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .multi-tab-banner.visible {
            display: block;
        }

        .broadcast-log {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            max-height: 150px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.85rem;
        }

        .broadcast-entry {
            padding: 0.25rem 0;
            border-bottom: 1px solid #e0e0e0;
            color: #666;
        }

        .broadcast-entry:last-child {
            border-bottom: none;
        }

        .sync-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-left: 1rem;
        }

        .sync-indicator.synced {
            background: #d4edda;
            color: #155724;
        }

        .sync-pulse {
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            animation: syncPulse 2s infinite;
        }

        @keyframes syncPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .offline-indicator {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #dc3545;
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 0.9rem;
            z-index: 9999;
        }

        .offline-indicator.visible {
            display: block;
        }
    </style>
</head>
<body>
    <div id="offlineIndicator" class="offline-indicator">You are currently offline. Some features may be unavailable.</div>
    <header>
        <a class="logo-container" href="index.html">
            <img src="images/and-logo.png" alt="Aquatic Nature Discovery Logo" class="logo">
            <h1>Aquatic Nature Discovery</h1>
        </a>
        <nav>
            <a href="index.html">Home</a>
            <a href="exhibits.html">Exhibits</a>
            <a href="conservation.html">Conservation</a>
            <a href="visit.html">Visit</a>
            <a href="support.html">Support Us</a>
            <a href="education.html">Education</a>
            <a href="events.html">Events</a>
            <a href="portal.html">Employee Portal</a>
        
            <div class="search-container">
                <form class="search-form" onsubmit="performSearch(event)">
                    <input type="text" id="searchInput" placeholder="Search..." class="search-input">
                    <button type="submit" class="search-btn">üîç</button>
                </form>
            </div></nav>
    </header>

    <section id="hero">
        <h2>Employee Portal</h2>
        <p>Access all aquarium management tools and systems</p>
    </section>

    <div class="portal-container" id="portalContent" style="display: none;">
        <div class="portal-header">
            <h2>Employee Portal</h2>
            <p>Welcome to your central hub for aquarium operations</p>
        </div>

        <div class="welcome-banner">
            <h3>üëã Welcome, Employee!</h3>
            <p>Today's date: <span id="currentDate"></span> | Current time: <span id="currentTime"></span>
                <span class="sync-indicator synced" id="syncIndicator">
                    <span class="sync-pulse"></span>
                    Tabs Synced
                </span>
            </p>
        </div>

        <div class="multi-tab-banner" id="multiTabBanner">
            ‚ö†Ô∏è Portal is open in multiple tabs. Actions will be synchronized across all tabs.
        </div>

        <div class="status-panel">
            <h3>üìä System Status Overview</h3>
            <div class="status-grid">
                <div class="status-item">
                    <h4>üõ°Ô∏è Security Systems</h4>
                    <p>6 cameras online</p>
                </div>
                <div class="status-item">
                    <h4>üê† Tank Management</h4>
                    <p>All systems operational</p>
                </div>
                <div class="status-item">
                    <h4>üë• Visitor Count</h4>
                    <p>127 visitors today</p>
                </div>
                <div class="status-item">
                    <h4>üå°Ô∏è Environmental</h4>
                    <p>Temperature: 22¬∞C</p>
                </div>
            </div>
        </div>

        <div class="tools-grid">
            <div class="tool-card">
                <span class="tool-icon">üê†</span>
                <h3>Tank Management System</h3>
                <p>Monitor water quality, temperature, pH levels, and control filtration systems across all aquarium tanks. Access real-time sensor data and automated controls.</p>
                <a href="tank-management.html" class="tool-button">Access Tank Management</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üìπ</span>
                <h3>Security Monitoring</h3>
                <p>View live security camera feeds from all areas of the aquarium. Monitor visitor safety, animal welfare, and facility security in real-time.</p>
                <a href="security.html" class="tool-button">View Security Cameras</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üìã</span>
                <h3>Maintenance Log</h3>
                <p>Record and track maintenance activities, equipment repairs, and scheduled inspections. Keep detailed logs of all aquarium operations.</p>
                <a href="maintenance.html" class="tool-button">Access Maintenance Log</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üë•</span>
                <h3>Staff Directory</h3>
                <p>Access employee contact information, schedules, and department assignments. Manage staff communications and coordination.</p>
                <a href="staff.html" class="tool-button">View Staff Directory</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üìä</span>
                <h3>Analytics Dashboard</h3>
                <p>View visitor statistics, revenue reports, and operational metrics. Generate reports for management and regulatory compliance.</p>
                <a href="analytics.html" class="tool-button">View Analytics</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üîß</span>
                <h3>Equipment Inventory</h3>
                <p>Track aquarium equipment, maintenance schedules, and replacement parts. Manage inventory and procurement processes.</p>
                <a href="inventory.html" class="tool-button">Access Inventory</a>
            </div>

            <div class="tool-card">
                <span class="tool-icon">üìù</span>
                <h3>Reports Generator</h3>
                <p>Create and manage operational reports including daily logs, incident reports, maintenance records, and visitor statistics.</p>
                <a href="reports.html" class="tool-button">Generate Reports</a>
            </div>
        </div>

        <div class="quick-actions">
            <h3>‚ö° Quick Actions</h3>
            <div class="action-buttons">
                <a href="#" class="action-button" data-action="emergency">üìû Emergency Contact</a>
                <a href="#" class="action-button" data-action="incident">üö® Incident Report</a>
                <a href="#" class="action-button warning" data-action="maintenance">‚ö†Ô∏è Maintenance Alert</a>
                <a href="#" class="action-button" data-action="log">üìù Daily Log</a>
                <a href="#" class="action-button" data-action="notifications">üîî Notifications</a>
                <a href="#" class="action-button danger" data-action="exit">üö™ Emergency Exit</a>
            </div>
            <div id="actionStatus" class="action-status"></div>
        </div>

        <div class="logout-section">
            <a href="#" class="logout-button" onclick="logout()">üö™ Logout</a>
        </div>
    </div>

    <div class="login-required" id="loginRequired">
        <h3>üîí Access Restricted</h3>
        <p>This employee portal requires authentication. Please log in to access aquarium management tools and systems.</p>
        <a href="login.html" class="login-button">Employee Login</a>
    </div>

    <footer>
        <p>&copy; 2025 Aquatic Nature Discovery | A nonprofit organization</p>
    </footer>

    <script>
        // ============================================
        // Broadcast Channel for Multi-Tab Sync
        // ============================================
        const authChannel = new BroadcastChannel('aquarium_auth');
        const portalChannel = new BroadcastChannel('aquarium_portal');
        let tabId = 'tab_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        let otherTabs = new Set();

        // Broadcast that this tab is open
        function announceTab() {
            portalChannel.postMessage({
                type: 'tab_open',
                tabId: tabId,
                timestamp: new Date().toISOString()
            });
        }

        // Listen for auth events
        authChannel.onmessage = (event) => {
            console.log('Auth broadcast received:', event.data);

            if (event.data.type === 'login') {
                // Another tab logged in
                console.log('Login detected from another tab');
                checkLoginStatus();
            } else if (event.data.type === 'logout') {
                // Another tab logged out
                console.log('Logout detected from another tab');
                localStorage.removeItem('employeeLoggedIn');
                checkLoginStatus();
            }
        };

        // Listen for portal events
        portalChannel.onmessage = (event) => {
            console.log('Portal broadcast received:', event.data);

            if (event.data.type === 'tab_open' && event.data.tabId !== tabId) {
                otherTabs.add(event.data.tabId);
                updateMultiTabBanner();
                // Respond to let the new tab know we exist
                portalChannel.postMessage({
                    type: 'tab_acknowledge',
                    tabId: tabId,
                    respondingTo: event.data.tabId
                });
            } else if (event.data.type === 'tab_acknowledge' && event.data.respondingTo === tabId) {
                otherTabs.add(event.data.tabId);
                updateMultiTabBanner();
            } else if (event.data.type === 'tab_close') {
                otherTabs.delete(event.data.tabId);
                updateMultiTabBanner();
            } else if (event.data.type === 'action') {
                // Sync action status across tabs
                const actionStatus = document.getElementById('actionStatus');
                if (actionStatus && event.data.tabId !== tabId) {
                    actionStatus.textContent = `[Synced] ${event.data.message}`;
                    actionStatus.className = `action-status ${event.data.statusType}`;
                }
            }
        };

        function updateMultiTabBanner() {
            const banner = document.getElementById('multiTabBanner');
            if (otherTabs.size > 0) {
                banner.classList.add('visible');
                banner.textContent = `‚ö†Ô∏è Portal is open in ${otherTabs.size + 1} tabs. Actions are synchronized.`;
            } else {
                banner.classList.remove('visible');
            }
        }

        // Check if user is logged in
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('employeeLoggedIn');

            if (isLoggedIn === 'true') {
                document.getElementById('portalContent').style.display = 'block';
                document.getElementById('loginRequired').style.display = 'none';
                updateDateTime();
            } else {
                document.getElementById('portalContent').style.display = 'none';
                document.getElementById('loginRequired').style.display = 'block';
            }
        }

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            const dateString = now.toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            const timeString = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });

            document.getElementById('currentDate').textContent = dateString;
            document.getElementById('currentTime').textContent = timeString;
        }

        // Logout function
        function logout() {
            localStorage.removeItem('employeeLoggedIn');

            // Broadcast logout to other tabs
            authChannel.postMessage({
                type: 'logout',
                tabId: tabId,
                timestamp: new Date().toISOString()
            });

            alert('You have been logged out successfully.');
            window.location.href = 'login.html';
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            announceTab();

            // Update time every minute
            setInterval(updateDateTime, 60000);

            // Wire up quick actions
            const actionStatus = document.getElementById('actionStatus');
            const quickActionButtons = document.querySelectorAll('.action-button[data-action]');

            const showStatus = (message, type = 'info') => {
                if (!actionStatus) return;
                actionStatus.textContent = message;
                actionStatus.className = `action-status ${type}`;

                // Broadcast action to other tabs
                portalChannel.postMessage({
                    type: 'action',
                    tabId: tabId,
                    message: message,
                    statusType: type,
                    timestamp: new Date().toISOString()
                });
            };

            quickActionButtons.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const action = btn.getAttribute('data-action');

                    switch (action) {
                        case 'emergency':
                            showStatus('Contacting on-site security dispatch at (555) 123-4567...', 'warning');
                            break;
                        case 'incident':
                            showStatus('Opening incident report form...', 'info');
                            window.location.href = 'reports.html';
                            break;
                        case 'maintenance':
                            showStatus('Flagged urgent maintenance. Facilities team notified.', 'warning');
                            break;
                        case 'log':
                            showStatus('Taking you to the daily log.', 'info');
                            window.location.href = 'reports.html';
                            break;
                        case 'notifications':
                            showStatus('Notifications synced. You are up to date.', 'success');
                            break;
                        case 'exit':
                            showStatus('Nearest emergency exit: east corridor by the kelp forest exhibit.', 'warning');
                            break;
                        default:
                            showStatus('Action completed.', 'info');
                    }
                });
            });

            updateOnlineStatus();
        });

        // Notify other tabs when closing
        window.addEventListener('beforeunload', () => {
            portalChannel.postMessage({
                type: 'tab_close',
                tabId: tabId
            });
        });

        // Auto-refresh login status every 30 seconds
        setInterval(checkLoginStatus, 30000);

        // Offline detection
        function updateOnlineStatus() {
            const indicator = document.getElementById('offlineIndicator');
            if (!navigator.onLine) {
                indicator.classList.add('visible');
            } else {
                indicator.classList.remove('visible');
            }
        }

        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);

        // Service Worker registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').catch(() => {});
        }
    </script>

    <script>
        // Search functionality
        function performSearch(event) {
            event.preventDefault();
            const query = document.getElementById('searchInput').value.trim();
            if (query) {
                window.location.href = `search.html?q=${encodeURIComponent(query)}`;
            }
        }
    </script>
    <script src="scripts/dark-mode.js"></script>
    <script src="scripts/session-tracker.js"></script>
</body>
</html>
